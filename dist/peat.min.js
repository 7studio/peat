!function(e,t){"use strict";var a=function(){function e(e){""===s&&(r(),o(),s="loading"),n(e)}function a(){s="loaded",c.length&&(c.forEach(function(e){e.call()}),c=[])}function o(){var e=t.createElement("script");e.src=i,t.body.appendChild(e)}function r(){var e=[],t="";for(var a in p)p.hasOwnProperty(a)&&""!==(t=p[a])&&e.push(a+"="+(Array.isArray(t)?t.join(","):t));i+="&"+e.join("&")}function n(e){"function"==typeof e&&c.push(e)}var i="https://maps.googleapis.com/maps/api/js?callback=PeatApiLoader.be0dcb4a530085046b0dff01b1e86271",s="",p={key:"",v:"3",signed_in:!0,language:"",region:"",libraries:["geometry"],client:"",sensor:!1},c=[];return{options:p,getApi:e,be0dcb4a530085046b0dff01b1e86271:a}}();e.PeatApiLoader=a}(window,document),function(e,t){"use strict";function a(e,a){this.img=null,this.map=null,this.div=t.createElement("div"),this.onApiLoadingDone=function(e){},this.initImageObject(e),this.initCallback(a),this.initApiHandler()}a.prototype.initImageObject=function(e){if("string"==typeof e?this.img=t.querySelector(e):this.img=e,!(this.img&&"nodeName"in this.img&&"IMG"===this.img.nodeName))throw new Error("Peat first argument should be a valid CSS selector or a img instance.")},a.prototype.initCallback=function(e){"function"==typeof e&&(this.onApiLoadingDone=e)},a.prototype.initMapInstance=function(){var e=a.getURLProp(this.img.src,"pathname").split("/").pop(),t="staticmap"===e?"Map":"StreetViewPanorama";this.map=new google.maps[t](this.div,{})},a.prototype.initApiHandler=function(){var t=this;"google"in e&&"maps"in google?(this.initMapInstance(),this.onApiLoadingDone(this)):PeatApiLoader.getApi(function(){t.initMapInstance(),t.onApiLoadingDone(t)})},a.prototype.getImageParams=function(){var e={},t=a.getURLProp(this.img.src,"search");t=t.substr(1),t.split("&").forEach(function(t){var o=t.substr(0,t.indexOf("=")),r=t.substr(t.indexOf("=")+1);r=a.decodeURIComponent(r),e.hasOwnProperty(o)?(Array.isArray(e[o])||(e[o]=[e[o]]),e[o].push(r)):e[o]=r});var o=["markers","path","style"];return o.map(function(t){e.hasOwnProperty(t)&&!Array.isArray(e[t])&&(e[t]=[e[t]])}),e},a.prototype.getMapData=function(){var e={mapOptions:{},markerOptions:[],mapTypeStyle:[],polylineOptions:[],polygonOptions:[]},t=this.getImageParams();for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];switch(o){case"center":e.mapOptions.center=a.getLatLngLiteral(r);break;case"zoom":e.mapOptions.zoom=parseInt(r,10);break;case"maptype":e.mapOptions.mapTypeId=r;break;case"markers":e.markerOptions=a.markersFormatter(r).map(a.markerOptionsDataMapper);break;case"style":e.mapTypeStyle=r.map(a.mapTypeStyleDataMapper);break;case"path":r.forEach(function(t){t=a.shapeOptionsDataMapper(t),e["poly"+(t.hasOwnProperty("path")?"line":"gon")+"Options"].push(t)})}}for(var n in e)e.hasOwnProperty(n)&&!Object.keys(e[n]).length&&delete e[n];return e},a.prototype.getMapGeoJson=function(){var e={},t=this.getMapData();return e.type="FeatureCollection",e.metadata={url:this.img.src,title:this.img.alt||this.img.title||""},e.features=[],t.hasOwnProperty("mapOptions")&&(e.metadata.options=t.mapOptions),t.hasOwnProperty("mapTypeStyle")&&(e.metadata.style=t.mapTypeStyle),t.hasOwnProperty("markerOptions")&&t.markerOptions.forEach(function(t){var a=t.position,o={type:"Feature",geometry:{type:"Point",coordinates:[a.lng,a.lat]}};delete t.position,Object.keys(t).length&&(o.properties=t),e.features.push(o)}),t.hasOwnProperty("polylineOptions")&&t.polylineOptions.forEach(function(t){var a=t.path.map(function(e){return[e.lng,e.lat]}),o={type:"Feature",geometry:{type:"LineString",coordinates:a}};delete t.path,Object.keys(t).length&&(o.properties=t),e.features.push(o)}),t.hasOwnProperty("polygonOptions")&&t.polygonOptions.forEach(function(t){var a=t.paths.map(function(e){return[e.lng,e.lat]}),o={type:"Feature",geometry:{type:"Polygon",coordinates:[a]}};delete t.paths,Object.keys(t).length&&(o.properties=t),e.features.push(o)}),e},a.prototype.getStreetViewPanoramaOptions=function(){var e={mode:"html5",pov:{pitch:0}},t=this.getImageParams();for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];switch(o){case"location":e.position=a.getLatLngLiteral(r);break;case"pano":e.pano=r;break;case"heading":case"pitch":e.pov[o]=parseFloat(r);break;case"fov":var n=t.size.split("x").map(function(e){return parseInt(e,10)});e.zoom=Math.sqrt(n[0]*n[0]/(n[1]*n[1]))/(2*Math.tan(r*Math.PI/180/2))}}return e},a.markersFormatter=function(e){var t=[];return e.forEach(function(e){var a,o=[],r=e.split("|");for(a=r.length-1;a>=0;a-=1)/^(color|size|label|icon|shadow):/gi.test(r[a])&&(o.push(r[a]),r.splice(a,1));r=r.map(function(e){return o.concat(e).join("|")}),t=t.concat(r)}),t},a.markerOptionsDataMapper=function(e){var t={};return e.split("|").forEach(function(e){if(/^(color|size|label|icon|shadow):/gi.test(e)){var o=e.substr(0,e.indexOf(":")),r=e.substr(e.indexOf(":")+1);switch(o){case"icon":t.icon=a.decodeURIComponent(r)}}else t.position=a.getLatLngLiteral(e)}),t},a.mapTypeStyleDataMapper=function(e){var t={stylers:[]};return e.split("|").forEach(function(e){var o=e.substr(0,e.indexOf(":")),r=e.substr(e.indexOf(":")+1);if("feature"==o)t.featureType=r;else if("element"==o)t.elementType=r;else{var n={};switch(o){case"color":case"hue":n[o]=a.getColorData(r).hex;break;case"gamma":case"lightness":case"saturation":n[o]=parseFloat(r);break;case"invert_lightness":n[o]=Boolean(r);break;case"weight":n[o]=parseInt(r,10);break;default:n[o]=r}t.stylers.push(n)}}),t},a.shapeOptionsDataMapper=function(e){var t={path:[]},o=-1!=e.indexOf("enc:")?/\|(?=weight|color|fillcolor|geodesic|enc)/gi:"|";return e.split(o).forEach(function(e){if(/^(weight|color|fillcolor|geodesic|enc):/gi.test(e)){var o=e.substr(0,e.indexOf(":")),r=e.substr(e.indexOf(":")+1);switch(o){case"weight":t.strokeWeight=parseInt(r,10);break;case"color":var n=a.getColorData(r,"stroke");t.strokeColor=n.hex,t.strokeOpacity=n.alpha;break;case"fillcolor":var i=a.getColorData(r,"fill");t.fillColor=i.hex,t.fillOpacity=i.alpha;break;case"geodisc":t.geodisc=Boolean(r);break;case"enc":try{t.path=google.maps.geometry.encoding.decodePath(r),t.path=t.path.map(function(e){return{lat:e.lat(),lng:e.lng()}})}catch(s){throw new Error("Encoded polylines or polygons can not be decoded without the Google Maps JavaScript API V3 geometry library.")}}}else t.path.push(a.getLatLngLiteral(e))}),t.hasOwnProperty("fillColor")&&(t.paths=t.path,delete t.path),t},a.getLatLngLiteral=function(e){if(e.match(/^([-+]?\d{1,2}[.]\d+),\s*([-+]?\d{1,3}[.]\d+)$/gi)){var t=e.split(",").map(function(e){return parseFloat(e)});return{lat:t[0],lng:t[1]}}var a=new XMLHttpRequest;if(a.open("GET","http://maps.google.com/maps/api/geocode/json?sensor=false&address="+encodeURIComponent(e),!1),a.send(null),200===a.status){var o=JSON.parse(a.responseText);return o.results[0].geometry.location}},a.getURLProp=function(e,a){var o=t.createElement("A");return o.href=e,o[a]},a.getColorData=function(e,t){t=t||"color";var a={hex:"",alpha:0},o={black:"#000000",brown:"#a52a2a",green:"#008000",purple:"#800080",yellow:"#ffff00",blue:"#0000ff",gray:"#808080",orange:"#ffa500",red:"#ff0000",white:"#ffffff"};switch(t){case"stroke":case"fill":a.alpha=.5;break;default:a.alpha=1}return-1!==e.indexOf("0x")?(a.hex="#"+e.substr(2,6).toLowerCase(),e.length>8&&(a.alpha=Math.round(parseInt(e.substr(8),16)/255*100)/100)):-1!==Object.keys(o).indexOf(e)&&(a.hex=o[e]),a},a.decodeURIComponent=function(e){return e=e.replace(/\+/gi,"%20"),decodeURIComponent(e)},e.Peat=a}(window,document);